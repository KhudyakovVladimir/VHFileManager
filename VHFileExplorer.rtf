{\rtf1\ansi\ansicpg1251\deff0\nouicompat\deflang1049{\fonttbl{\f0\fmodern Consolas;}{\f1\fmodern\fcharset204 Consolas;}{\f2\fnil\fcharset0 Calibri;}}
{\colortbl ;\red204\green120\blue50;\red169\green183\blue198;\red152\green118\blue170;\red104\green151\blue187;\red187\green181\blue41;\red255\green198\blue109;\red106\green135\blue89;\red128\green128\blue128;}
{\*\generator Riched20 10.0.18362}\viewkind4\uc1 
\pard\box\brdrdash\brdrw0 \sa200\sl276\slmult1\cf1\f0\fs30\lang9 package \cf2 com.example.filemanager\cf1 ;\line\line import \cf2 android.Manifest\cf1 ;\line import \cf2 android.app.AlertDialog\cf1 ;\line import \cf2 android.app.ListActivity\cf1 ;\line import \cf2 android.content.DialogInterface\cf1 ;\line import \cf2 android.content.Intent\cf1 ;\line import \cf2 android.content.pm.PackageManager\cf1 ;\line import \cf2 android.net.Uri\cf1 ;\line import \cf2 android.os.Environment\cf1 ;\line import \cf2 android.view.LayoutInflater\cf1 ;\line import \cf2 android.view.Menu\cf1 ;\line import \cf2 android.view.View\cf1 ;\line import \cf2 android.webkit.MimeTypeMap\cf1 ;\line import \cf2 android.widget.*\cf1 ;\line import \cf2 android.os.Bundle\cf1 ;\line import \cf2 androidx.appcompat.app.AppCompatActivity\cf1 ;\line import \cf2 androidx.core.app.ActivityCompat\cf1 ;\line import \cf2 androidx.core.content.ContextCompat\cf1 ;\line import \cf2 androidx.core.content.FileProvider\cf1 ;\line import \cf2 java.io.File\cf1 ;\line import \cf2 java.util.Arrays\cf1 ;\line\line public class \cf2 ViewV \cf1 extends \cf2 AppCompatActivity \cf1 implements \cf2 AdapterView.OnItemLongClickListener\cf1 , \cf2 ListView.OnItemClickListener\{\line     TextView \cf3 textView\cf1 ;\line     \cf2 ListView \cf3 listView\cf1 ;\line     \cf2 ArrayAdapter<File> \cf3 arrayAdapter\cf1 ;\line     \cf2 String \cf3 mainFileName\cf1 ;\line     \cf2 String \cf3 folderName\cf1 ;\line     private static final int \cf3\i REQUEST_PERMISSION_WRITE \cf2\i0 = \cf4 1001\cf1 ;\line\line     \cf5 @Override\line     \cf1 protected void \cf6 onCreate\cf2 (Bundle savedInstanceState) \{\line         \cf1 super\cf2 .onCreate(savedInstanceState)\cf1 ;\line         \cf2 setContentView(R.layout.\cf3\i viewv\cf2\i0 )\cf1 ;\line\line         \cf3 textView \cf2 = findViewById(R.id.\cf3\i textView\cf2\i0 )\cf1 ;\line         \cf3 listView \cf2 = findViewById(android.R.id.\cf3\i list\cf2\i0 )\cf1 ;\line\line         \cf3 textView\cf2 .setText(Model.\cf3\i mainFileName\cf2\i0 )\cf1 ;\line         \cf2 checkPermissions()\cf1 ;\line\line         if \cf2 (!Environment.\i getExternalStorageState\i0 ().equals(Environment.\cf3\i MEDIA_MOUNTED\cf2\i0 )) \{\line             System.\cf3\i out\cf2\i0 .println(\cf7 "SD-\f1\lang1049\'ea\'e0\'f0\'f2\'e0 \'ed\'e5 \'e4\'ee\'f1\'f2\'f3\'ef\'ed\'e0: " \cf2 + Environment.\i getExternalStorageState\i0 ())\cf1 ;\line         \cf2\}\cf1 else \cf2\{\line             File sdPath = Environment.\i getExternalStorageDirectory\i0 ()\cf1 ;\line         \cf2\}\line\line         \cf1 if \cf2 (Model.\cf3\i flagFirstCreated\cf2\i0 )\{\line             \cf8 //\'ef\'ee\'eb\'f3\'f7\'e0\'e5\'ec \'ea\'ee\'f0\'ed\'e5\'e2\'f3\'fe \'ef\'e0\'ef\'ea\'f3 \'e8 \'f1\'ee\'f0\'f2\'e8\'f0\'f3\'e5\'ec \'f1\'ef\'e8\'f1\'ee\'ea\line             \cf2 Model.\cf3\i listOfFiles \cf2\i0 = Model.\i setFileName\i0 (Model.\cf3\i ROOT_PATH\cf2\i0 ).listFiles()\cf1 ;\line             assert \cf2 Model.\cf3\i listOfFiles \cf2\i0 != \cf1 null;\line             \cf2 Arrays.\i sort\i0 (Model.\cf3\i listOfFiles\cf2\i0 )\cf1 ;\line\line             \cf8 //\'ef\'e5\'f0\'e5\'e4\'e0\'b8\'ec \'e5\'e3\'ee \'e0\'e4\'e0\'ef\'f2\'e5\'f0\'f3 \'e8 \'e4\'ee\'e1\'e0\'e2\'eb\'ff\'e5\'ec \'e2 \'f1\'ef\'e8\'f1\'ee\'ea\line             \cf3 arrayAdapter \cf2 = \cf1 new \cf2 ArrayAdapter<>(\cf1 this, \cf2 android.R.layout.\cf3\i simple_list_item_1\cf1\i0 , \cf2 Model.\cf3\i listOfFiles\cf2\i0 )\cf1 ;\line             \cf3 listView\cf2 .setAdapter(\cf3 arrayAdapter\cf2 )\cf1 ;\line             \cf3 listView\cf2 .setOnItemClickListener(\cf1 this\cf2 )\cf1 ;\line             \cf3 listView\cf2 .setOnItemLongClickListener(\cf1 this\cf2 )\cf1 ;\line             \cf2 Model.\cf3\i heap\cf2\i0 .add(Model.\cf3\i ROOT_PATH\cf2\i0 )\cf1 ;\line             \cf2 Model.\cf3\i flagFirstCreated \cf2\i0 = \cf1 false;\line         \cf2\}\line\line         \cf1 else \cf2\{\line             Model.\cf3\i listOfFiles \cf2\i0 = Model.\i setFileName\i0 (Model.\cf3\i mainFileName\cf2\i0 ).listFiles()\cf1 ;\line\line             if\cf2 (Model.\cf3\i listOfFiles \cf2\i0 != \cf1 null\cf2 ) \{\line                 Arrays.\i sort\i0 (Model.\cf3\i listOfFiles\cf2\i0 )\cf1 ;\line                 \cf3 arrayAdapter \cf2 = \cf1 new \cf2 ArrayAdapter<>(\cf1 this, \cf2 android.R.layout.\cf3\i simple_list_item_1\cf1\i0 , \cf2 Model.\cf3\i listOfFiles\cf2\i0 )\cf1 ;\line                 \cf3 listView\cf2 .setAdapter(\cf3 arrayAdapter\cf2 )\cf1 ;\line                 \cf3 listView\cf2 .setOnItemClickListener(\cf1 this\cf2 )\cf1 ;\line                 \cf3 listView\cf2 .setOnItemLongClickListener(\cf1 this\cf2 )\cf1 ;\line             \cf2\}\cf1 else \cf2\{\line                 Toast.\i makeText\i0 (\cf1 this, \cf7 "No files here."\cf1 , \cf2 Toast.\cf3\i LENGTH_SHORT\cf2\i0 ).show()\cf1 ;\line             \cf2\}\line         \}\line\line         \cf3 listView\cf2 .setAdapter(\cf3 arrayAdapter\cf2 )\cf1 ;\line     \cf2\}\line\line     \cf1 void \cf6 openFolder\cf2 (String folderName)\{\line         recreate()\cf1 ;\line     \cf2\}\line\line     \cf5 @Override\line     \cf1 public void \cf6 onBackPressed\cf2 () \{\line         \cf1 if\cf2 (Model.\cf3\i heap\cf2\i0 .size() > \cf4 1\cf2 )\{\line             Model.\cf3\i count\cf2\i0 --\cf1 ;\line             \cf2 Model.\cf3\i heap\cf2\i0 .remove(Model.\cf3\i heap\cf2\i0 .size() - \cf4 1\cf2 )\cf1 ;\line             int \cf2 position = Model.\cf3\i heap\cf2\i0 .size()\cf1 ;\line             \cf2 Model.\cf3\i mainFileName \cf2\i0 = Model.\cf3\i heap\cf2\i0 .get(position - \cf4 1\cf2 )\cf1 ;\line             \cf2 openFolder(Model.\cf3\i mainFileName\cf2\i0 )\cf1 ;\line             \cf2 System.\cf3\i out\cf2\i0 .println(\cf7 "onBackPressed : " \cf2 + Model.\cf3\i count \cf2\i0 + \cf7 " " \cf2 + Model.\cf3\i heap\cf2\i0 .toString())\cf1 ;\line         \cf2\}\line     \}\line\line\line     \cf8 //\'ec\'e5\'f2\'ee\'e4 \'ee\'ef\'f0\'e5\'e4\'e5\'eb\'ff\'e5\'f2 MIME-Type \'e8 \'e2\'ee\'e7\'e2\'f0\'e0\'f9\'e0\'e5\'f2 \'e5\'e3\'ee \'e2 String\line     \cf1 public static \cf2 String \cf6 getMimeType\cf2 (String url) \{\line         String extension = url.substring(url.lastIndexOf(\cf7 "."\cf2 ))\cf1 ;\line         \cf2 String mimeTypeMap = MimeTypeMap.\i getFileExtensionFromUrl\i0 (extension)\cf1 ;\line         \cf2 String mimeType = MimeTypeMap.\i getSingleton\i0 ().getMimeTypeFromExtension(mimeTypeMap)\cf1 ;\line         \cf2 System.\cf3\i out\cf2\i0 .println(\cf7 "MIME-TYPE is : " \cf2 + mimeType)\cf1 ;\line         return \cf2 mimeType\cf1 ;\line\line     \cf2\}\line\line     \cf1 private boolean \cf6 checkPermissions\cf2 ()\{\line\line         \cf1 if\cf2 (!isExternalStorageReadable() || !isExternalStorageWriteable())\{\line             Toast.\i makeText\i0 (\cf1 this, \cf7 "\'c2\'ed\'e5\'f8\'ed\'e5\'e5 \'f5\'f0\'e0\'ed\'e8\'eb\'e8\'f9\'e5 \'ed\'e5 \'e4\'ee\'f1\'f2\'f3\'ef\'ed\'ee"\cf1 , \cf2 Toast.\cf3\i LENGTH_LONG\cf2\i0 ).show()\cf1 ;\line             return false;\line         \cf2\}\line         \cf1 int \cf2 permissionCheck = ContextCompat.\i checkSelfPermission\i0 (\cf1 this, \cf2 Manifest.permission.\cf3\i WRITE_EXTERNAL_STORAGE\cf2\i0 )\cf1 ;\line         if\cf2 (permissionCheck!= PackageManager.\cf3\i PERMISSION_GRANTED\cf2\i0 )\{\line             ActivityCompat.\i requestPermissions\i0 (\cf1 this, new \cf2 String[]\{Manifest.permission.\cf3\i WRITE_EXTERNAL_STORAGE\cf2\i0\}\cf1 , \cf3\i REQUEST_PERMISSION_WRITE\cf2\i0 )\cf1 ;\line             return false;\line         \cf2\}\line         \cf1 return true;\line     \cf2\}\line\line     \cf8 // \'ef\'f0\'ee\'e2\'e5\'f0\'ff\'e5\'ec, \'e4\'ee\'f1\'f2\'f3\'ef\'ed\'ee \'eb\'e8 \'e2\'ed\'e5\'f8\'ed\'e5\'e5 \'f5\'f0\'e0\'ed\'e8\'eb\'e8\'f9\'e5 \'e4\'eb\'ff \'f7\'f2\'e5\'ed\'e8\'ff \'e8 \'e7\'e0\'ef\'e8\'f1\'e8\line     \cf1 public boolean \cf6 isExternalStorageWriteable\cf2 ()\{\line         String state = Environment.\i getExternalStorageState\i0 ()\cf1 ;\line         return  \cf2 Environment.\cf3\i MEDIA_MOUNTED\cf2\i0 .equals(state)\cf1 ;\line     \cf2\}\line     \cf8 // \'ef\'f0\'ee\'e2\'e5\'f0\'ff\'e5\'ec, \'e4\'ee\'f1\'f2\'f3\'ef\'ed\'ee \'eb\'e8 \'e2\'ed\'e5\'f8\'ed\'e5\'e5 \'f5\'f0\'e0\'ed\'e8\'eb\'e8\'f9\'e5 \'f5\'ee\'f2\'ff \'e1\'fb \'f2\'ee\'eb\'fc\'ea\'ee \'e4\'eb\'ff \'f7\'f2\'e5\'ed\'e8\'ff\line     \cf1 public boolean \cf6 isExternalStorageReadable\cf2 ()\{\line         String state = Environment.\i getExternalStorageState\i0 ()\cf1 ;\line         return  \cf2 (Environment.\cf3\i MEDIA_MOUNTED\cf2\i0 .equals(state) ||\line                 Environment.\cf3\i MEDIA_MOUNTED_READ_ONLY\cf2\i0 .equals(state))\cf1 ;\line     \cf2\}\line\line     \cf5 @Override\line     \cf1 public boolean \cf6 onItemLongClick\cf2 (AdapterView<?> parent\cf1 , \cf2 View view\cf1 , int \cf2 position\cf1 , long \cf2 id) \{\line         String itemName = (String) \cf3 listView\cf2 .getItemAtPosition(position)\cf1 ;\line         final \cf2 AlertDialog.Builder builder = \cf1 new \cf2 AlertDialog.Builder(\cf1 this\cf2 )\cf1 ;\line         \cf2 builder.setTitle(\cf7 "\'c2\'fb\'e1\'e5\'f0\'e5\'f2\'e5 \'e4\'e5\'e9\'f1\'f2\'e2\'e8\'e5"\cf2 )\cf1 ;\line         \cf2 builder.setPositiveButton(\cf7 "open"\cf1 , new \cf2 DialogInterface.OnClickListener() \{\line             \cf5 @Override\line             \cf1 public void \cf6 onClick\cf2 (DialogInterface dialog\cf1 , int \cf2 which) \{\line\line             \}\line         \})\cf1 ;\line         return false;\line     \cf2\}\line\line     \cf1 void \cf6 openFile\cf2 (String localUri)\{\line         \cf8 //\'f2\'f3\'f2 \'f3\'e6\'e5 \'ea\'e0\'ea \'f5\'ee\'f2\'e8\'f2\'e5 \'f2\'e0\'ea \'e8 \'f4\'ee\'f0\'ec\'e8\'f0\'f3\'e9\'f2\'e5 \'ef\'f3\'f2\'fc, \'f5\'ee\'f2\'fc \'f7\'e5\'f0\'e5\'e7 Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES) + \'e8\'ec\'ff \'f4\'e0\'e9\'eb\'e0\line         \cf2 File file = \cf1 new \cf2 File(localUri)\cf1 ;\line         \cf2 Uri contentUri = FileProvider.\i getUriForFile\i0 (\cf1 this, this\cf2 .getApplicationContext().getPackageName() + \cf7 ".provider"\cf1 , \cf2 file)\cf1 ;\line         \cf2 Intent openFileIntent = \cf1 new \cf2 Intent(Intent.\cf3\i ACTION_VIEW\cf2\i0 )\cf1 ;\line         \cf2 openFileIntent.setDataAndTypeAndNormalize(contentUri\cf1 , \cf2\i getMimeType\i0 (\cf3 folderName\cf2 ))\cf1 ;\line         \cf2 openFileIntent.addFlags(Intent.\cf3\i FLAG_GRANT_WRITE_URI_PERMISSION \cf2\i0 | Intent.\cf3\i FLAG_GRANT_READ_URI_PERMISSION\cf2\i0 )\cf1 ;\line         \cf2 startActivity(openFileIntent)\cf1 ;\line     \cf2\}\line\line     \cf5 @Override\line     \cf1 public boolean \cf6 onCreateOptionsMenu\cf2 (Menu menu) \{\line         getMenuInflater().inflate(R.menu.\cf3\i action_bar_menu\cf1\i0 , \cf2 menu)\cf1 ;\line         return true;\line     \cf2\}\line\line     \cf5 @Override\line     \cf1 public void \cf6 onItemClick\cf2 (AdapterView<?> parent\cf1 , \cf2 View view\cf1 , int \cf2 position\cf1 , long \cf2 id) \{\line         \cf8 //\'ef\'ee\'eb\'f3\'f7\'e0\'e5\'ec \'ef\'ee\'e7\'e8\'f6\'e8\'fe \'f1\'ef\'e8\'f1\'ea\'e0, \'e4\'ee\'e1\'e0\'e2\'eb\'ff\'e5\'ec \'e5\'b8 \'e2 \'eb\'e8\'f1\'f2 \'e8 \'e2\'fb\'e2\'ee\'e4\'e8\'ec \'e2 textview\line         \cf3 folderName \cf2 = \cf3 listView\cf2 .getItemAtPosition(position).toString()\cf1 ;\line         \cf2 System.\cf3\i out\cf2\i0 .println(\cf7 "ON_ITEM_CLICK = " \cf2 + \cf3 folderName\cf2 )\cf1 ;\line         \cf2 Uri intentUri = Uri.\i parse\i0 (\cf3 folderName\cf2 )\cf1 ;\line\line         \cf2 File file = \cf1 new \cf2 File(\cf3 folderName\cf2 )\cf1 ;\line\line         if\cf2 (file.isDirectory())\{\line\line         \}\line         \cf1 if\cf2 (file.isFile())\{\line             openFile(\cf3 folderName\cf2 )\cf1 ;\line         \cf2\}\line         Model.\cf3\i mainFileName \cf2\i0 = \cf3 folderName\cf1 ;\line\line         \cf2 Model.\cf3\i heap\cf2\i0 .add(\cf3 folderName\cf2 )\cf1 ;\line         \cf2 Model.\cf3\i count\cf2\i0 ++\cf1 ;\line         \cf2 System.\cf3\i out\cf2\i0 .println(\cf7 "onItemClick : " \cf2 + Model.\cf3\i count \cf2\i0 + \cf7 " " \cf2 + Model.\cf3\i heap\cf2\i0 .toString())\cf1 ;\line\line         \cf3 textView\cf2 .setText(\cf3 folderName\cf2 )\cf1 ;\line         \cf2 openFolder(\cf3 mainFileName\cf2 )\cf1 ;\line     \cf2\}\line\}\line\par

\pard\sa200\sl276\slmult1\cf0\f2\fs22\lang9\par
}
 